<div id="planning1">
    <style type="text/css" media="print">
        @page { size: landscape; }
    </style>
    <header>

        <div class="toobar">
            <div class="fill">
                <div class="container-fluid">

                    <img *ngIf="!print"src="image/menu/chantiers_grand_gris.png" alt="planning">

                    <span *ngIf="!print">Suivis matériels</span>



                </div>
            </div>
        </div>

    </header>


    <div class=" container-fluid ">


        <div *ngIf="!print" class=" col-sm-offset-10" style="margin-top: 5px; margin-bottom:5px; font-size: 16px;">
            <a  [routerLink]="['/home']" class="glyphicon glyphicon-plus-sign fleche1"></a><span class="blan1">Retour accueil</span>
        </div>


        <div class="col-sm-12">
            <form method="POST" action="#">

                <h3>Fiche matériel</h3>

                <div style="height: auto; max-width: 20%;">
                    <img *ngIf="url" [src]="url" alt="..." class="img-thumbnail col-sm-12"/>
                    <img *ngIf="!url && model.image"
                         src="http://{{loc}}:4000/image/matvehi/{{model.id_vehmat}}/{{model.image}}" alt="..."
                         class="img-thumbnail col-sm-12"/>
                    <img *ngIf="!url && !model.image" src="image/test.ico" alt="..." class="img-thumbnail images"/>
                    <input type="file" ng2FileSelect [uploader]="uploaderImg" (change)="readUrl($event)"/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Modèle : </span><input type="text" name="libelle"  [(ngModel)]="model.libelle" class="col-sm-8 " style="color: #993300; font-weight: bold;" /><!--variable pour value-->
                </div>


                <div class="form-group">
                    <span class="col-sm-2 " >Marque :</span><input type="text" [(ngModel)]="model.marque" name="marque" value="" class="col-sm-1 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Energie :</span>
                    <select name="energie"   [(ngModel)]="model.energie" class="col-sm-1" >
                        <option [selected]="model.energie =='Diesel'">Diesel</option>
                        <option [selected]="model.energie =='Essence'">Essence</option>
                        <option [selected]="model.energie =='Electrique'">Electrique</option>
                        <option [selected]="model.energie =='Gaz'">Gaz</option>
                        <option [selected]="model.energie =='Fuel'">Fuel</option>
                        <option [selected]="model.energie =='Hybride'">Hybride</option>
                        <option [selected]="model.energie =='Monophase'">Monophase</option>
                        <option [selected]="model.energie =='Triphasé'">Triphasé</option>
                    </select>
                </div>


                <div class="form-group">
                    <span class="col-sm-2 " >Type :</span><input type="text" [(ngModel)]="model.type" name="type" value="" class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Type véhicule :</span>
                    <select name="status"   [(ngModel)]="model.annee" class="col-sm-1" >
                        <option [selected]="model.annee =='Nacelle'">Nacelle</option>
                        <option [selected]="model.annee =='Manitou'">Manitou</option>
                    </select>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Puissance :</span><input type="text" name="puissance" [(ngModel)]="model.puissance" value="" class="col-sm-1 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Immatriculation :</span><input type="text" name="immat" value="" [(ngModel)]="model.immatriculation" class="col-sm-2 "/><!--variable pour value-->
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Genre :</span><input type="text" name="genre" [(ngModel)]="model.genre" value="" class="col-sm-1 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >N° série :</span><input type="text" name="nserie" [(ngModel)]="model.nserie" value="" class="col-sm-1 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Carrosserie :</span><input type="text" name="carroserie" [(ngModel)]="model.carrosserie" value="" class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Pl. ass. :</span>
                    <select name="pl_ass"   [(ngModel)]="model.pl_ass" class="col-sm-1" >
                        <option [selected]="model.pl_ass =='0'">0</option>
                    </select>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Rég mot. (tr/min) :</span><input type="number" name="regmot" [(ngModel)]="model.regmot" value="" class="col-sm-1 " min="0"/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Bruit (dBA) :</span><input type="number" name="bruit" [(ngModel)]="model.bruit" value="" class="col-sm-2 " min="0"/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >GPS :</span><input type="text" name="gps" value="" [(ngModel)]="model.gps" class="col-sm-1 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Largeur :</span><input type="text" name="largeur" [(ngModel)]="model.largeur" value="" class="col-sm-1 "/>
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Surface :</span><input type="text" name="surface" [(ngModel)]="model.surface" value="" class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Poids à vide :</span><input type="text" name="poidsvide" [(ngModel)]="model.poidsvide" value="" class="col-sm-1 "/>
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >PoidsTR :</span><input type="text" name="poidstr" [(ngModel)]="model.podstr" value="" class="col-sm-1 "/>
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Poids TC :</span><input type="text" name="poidstc" value="" class="col-sm-2 "/>
                </div>


                <div class="form-group">
                    <span class="col-sm-2 " >Remarque :</span><input type="text" name="remarque" value="" [(ngModel)]="model.remarque" class="col-sm-8 " style="height: 50px;" />
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Date ctrl Tech :</span><input type="date" name="datectrltech"  [ngModel]="model.datectrltech | date:'yyyy-MM-dd'" (ngModelChange)="model.datectrltech = $event" [value]="model.datectrltech | date:'yyyy-MM-dd'" class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Date 1er ctrl :</span><input type="date" name="date1ctrl"  [ngModel]="model.date1ctrl | date:'yyyy-MM-dd'" (ngModelChange)="model.date1ctrl = $event" [value]="model.date1ctrl | date:'yyyy-MM-dd'"  class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Date d'achat :</span><input type="date" name="dateachat"  [ngModel]="model.dateachat | date:'yyyy-MM-dd'" (ngModelChange)="model.dateachat = $event" [value]="model.dateachat | date:'yyyy-MM-dd'" class="col-sm-2 " placeholder="JJ/MM/AAAA"/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Date de vente :</span><input type="date" name="datevente"  [ngModel]="model.dateachat | date:'yyyy-MM-dd'" (ngModelChange)="model.datevente = $event" [value]="model.datevente | date:'yyyy-MM-dd'" class="col-sm-2 " placeholder="JJ/MM/AAAA"/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Visite Ampliroll :</span><input type="date" name="visite_ampliroll"  [ngModel]="model.visite_ampliroll | date:'yyyy-MM-dd'" (ngModelChange)="model.visite_ampliroll = $event" [value]="model.visite_ampliroll | date:'yyyy-MM-dd'" class="col-sm-2 " />
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Visite grue :</span><input type="date" name="visite_grue"   [ngModel]="model.visite_grue | date:'yyyy-MM-dd'" (ngModelChange)="model.visite_grue = $event" [value]="model.visite_grue | date:'yyyy-MM-dd'" class="col-sm-2 "/>
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Pneu A.V. :</span><input type="text" name="pneuav"  [(ngModel)]="model.pneu_av" class="col-sm-2 "/>
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Pneu A.R. :</span><input type="text" name="pneuar"  [(ngModel)]="model.pneu_ar" class="col-sm-2 "/>
                </div>

                <div class="form-group">
                    <span class="col-sm-2 " >Code poste :</span><input type="text" name="code_poste" value="" [(ngModel)]="model.code_poste" class="col-sm-2 "/><!--variable pour value-->
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Début de garantie :</span><input type="date" name="dgarant"  class="col-sm-2 " [ngModel]="model.dgarant  | date:'yyyy-MM-dd'" (ngModelChange)="model.dgarant = $event" [value]="model.dgarant | date:'yyyy-MM-dd'" />
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Fin de garantie :</span><input type="date" name="fgarant"  class="col-sm-2 " [ngModel]="model.fgarant | date:'yyyy-MM-dd'" (ngModelChange)="model.fgarant = $event" [value]="model.fgarant | date:'yyyy-MM-dd'" />
                </div>
                <div class="form-group">
                    <span class="col-sm-2 " >Géolocalisation :</span><input type="text" name="geolocalisation" value="" [(ngModel)]="model.geolocalisation" class="col-sm-2 " placeholder="https://www"/><!--variable pour value-->
                </div>


                <div class="form-group">
                    <span *ngIf="!print" class="col-sm-1 " >Archivé:</span>
                    <div class="col-sm-1">
                        <div *ngIf="!print" class="checkbox-inline" >
                            <label >
                                <input *ngIf="!print" type="checkbox" value="" id="archive" style="margin: 0; ">
                            </label>
                        </div>
                    </div>
                </div>



                <button *ngIf="!print && (droitsuser.modifproa || droitsuser.modifprov)" class="btn btn-default input-sm col-sm-offset-11" (click)="modify(id_vehmat); uploaderImg.queue[0].upload();">Modifier</button>



            </form>

            <div class="col-sm-12" style="margin-top: 10px;">

                <div class=" table-responsive">
                    <h5 style="margin-bottom: 0;">Entretien</h5>
                    <table class="table table-bordered" >
                        <thead >
                        <tr>
                            <th class="col-sm-2">Date</th>
                            <th class="col-sm-6">Motif</th>
                            <th class="col-sm-2">Prix (€)</th>
                            <th class="col-sm-2">Action</th>
                        </tr>
                        </thead>
                        <tbody>

                        <tr *ngFor="let entretien of entretiens, let i= index">
                            <td><input type="date" name="entredate{{i}}" value="" class="col-sm-12" [ngModel]="entretiens[i].date | date:'yyyy-MM-dd'" (ngModelChange)="entretiens[i].date = $event" [value]="entre.date | date:'yyyy-MM-dd'"/></td>
                            <td><input type="text" name="entremotif{{i}}" value="" class="col-sm-12"[(ngModel)]="entretiens[i].motif"/></td>
                            <td><input type="text" name="entreprix{{i}}" value="" class="col-sm-12"[(ngModel)]="entretiens[i].tarif"/></td>
                            <td *ngIf="!print"><button *ngIf="droitsuser.supproa || droitsuser.supprov" (click)="deleteEntre(entretiens[i].id_entretien )">Supprimer</button></td>
                        </tr>
                        </tbody>




                    </table>
                    <form method=""  (ngSubmit)=" addEntretien()" >
                        <table class="table table-bordered">
                            <tbody>

                                <tr *ngIf="!print">
                                    <td class="col-sm-2"><input type="date" name="date" value=""  class="col-sm-12" [(ngModel)]="entre.date"/></td>
                                    <td class="col-sm-6"><input type="text" name="motif" value="" class="col-sm-12" [(ngModel)]="entre.motif"/></td>
                                    <td class="col-sm-2"><input type="text" name="tarif" value="" class="col-sm-12" [(ngModel)]="entre.tarif"/></td>
                                    <td class="col-sm-2"><button *ngIf="droitsuser.ajoutproa || droitsuser.ajoutprov" type="submit" [disabled]="loading">Ajouter</button></td>

                                </tr>

                            </tbody>

                        </table>
                    </form>
                </div>


            </div>

            <button class="col-sm-offset-10 col-sm-1 btn" type="button" *ngIf="!print && (droitsuser.accesproa || droitsuser.accesprov)" (click)=" imprimer()">Imprimer</button>


            <!--<div class="col-sm-6" style="margin-top: 10px;">

                <div class=" table-responsive">
                    <h5 style="margin-bottom: 0;">Géolocalisation</h5>
                    <table class="table table-bordered" >
                        <thead>
                        <tr>
                            <th>Début</th>
                            <th>Immatriculation</th>
                            <th>Conducteur</th>
                            <th>PDI Début</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="text" name="geodebut" value="" class="col-sm-12" /></td>
                            <td><input type="text" name="geoimmatricul" value="" class="col-sm-12"/></td>
                            <td><input type="text" name="geoonducteur" value="" class="col-sm-12"/></td>
                            <td><input type="text" name="geopdi" value="" class="col-sm-12"/></td>
                        </tr>
                        </tbody>


                    </table>
                </div>

            </div>-->


            <div class="col-sm-12">
                <h3 >GED</h3>

                <div class="col-md-3">

                    <h3>Choisir Fichier</h3>

                    <div ng2FileDrop
                         [ngClass]="{'nv-file-over': hasBaseDropZoneOver}"
                         (fileOver)="fileOverBase($event)"
                         [uploader]="uploader"
                         class="well my-drop-zone">
                        Base drop zone
                    </div>

                    <input type="file" ng2FileSelect [uploader]="uploader" multiple  /><br/>

                </div>

                <div class="col-md-5" style="margin-bottom: 40px">

                    <h3>File d'attente</h3>

                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Etat</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let item of uploader.queue">
                            <td><strong>{{ item?.file?.name }}</strong></td>
                            <td class="text-center">
                                <span *ngIf="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                                <span *ngIf="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
                                <span *ngIf="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
                            </td>
                            <td nowrap>
                                <button type="button" class="btn btn-success btn-xs"
                                        (click)="item.upload(); getGed(id_vehmat)" [disabled]="item.isReady || item.isUploading || item.isSuccess">
                                    <span class="glyphicon glyphicon-upload"></span> Mettre en ligne
                                </button>
                                <button type="button" class="btn btn-warning btn-xs"
                                        (click)="item.cancel()" [disabled]="!item.isUploading">
                                    <span class="glyphicon glyphicon-ban-circle"></span> Annuler
                                </button>
                                <button type="button" class="btn btn-danger btn-xs"
                                        (click)="item.remove()">
                                    <span class="glyphicon glyphicon-trash"></span> Retirer de la liste
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <div>
                        <div>
                            Avancement:
                            <div class="progress" style="">
                                <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': uploader.progress + '%' }"></div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-success btn-s"
                                (click)="uploader.uploadAll(); getGed(id_vehmat);" [disabled]="!uploader.getNotUploadedItems().length">
                            <span class="glyphicon glyphicon-upload"></span> Tout mettre en ligne
                        </button>
                        <button type="button" class="btn btn-warning btn-s"
                                (click)="uploader.cancelAll()" [disabled]="!uploader.isUploading">
                            <span class="glyphicon glyphicon-ban-circle"></span> Tout annuler
                        </button>
                        <button type="button" class="btn btn-danger btn-s"
                                (click)="uploader.clearQueue()" [disabled]="!uploader.queue.length">
                            <span class="glyphicon glyphicon-trash"></span> Tout retirer de la liste
                        </button>
                    </div>

                </div>

                <div class="col-md-4" style="margin-bottom: 40px">

                    <h3>GED</h3>

                    <table class="table">
                        <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Date d'ajout</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let item of ged">
                            <td><strong><a href="http://{{loc}}:4000/ged/matvehi/{{id_vehmat}}/{{item.url}}" target="_blank">{{ item.nom }}</a></strong></td>
                            <td nowrap>{{item.date_ajout | date : 'dd/MM/yyyy'}}</td>
                        </tr>
                        </tbody>
                    </table>

                </div>

            </div>





    </div><!--fin container fluid-->
</div><!--fin id-->
</div>