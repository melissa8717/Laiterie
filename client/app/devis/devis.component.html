<div id="devis" style="border:none;" >
    <header style="color:#B2B2B2;">

        <div class="toobar">
            <div class="fill">
                <div class="container-fluid">

                    <img *ngIf="!print" src="image/menu/gestion_grand_gris.png">

                    <span *ngIf="!print">Devis</span>

                </div>
            </div>
        </div>

    </header>
    <body style="margin:0px;font-size: 18px;background-color: white;">
    <div *ngIf="!print" class=" col-sm-offset-10" style="margin-top: 5px; margin-bottom:5px; font-size: 16px;">
        <a  [routerLink]="['/home']" class="glyphicon glyphicon-plus-sign fleche1"></a><span class="blan1">Retour accueil</span>

    </div>
    <button class="col-sm-offset-8 col-sm-1 btn" type="button"  *ngIf="!print && droitsuser.accesdev" (click)=" imprimer()">Imprimer </button>
    <!--    <button [routerLink]="['/devis_pdf/'+devis.id_devis+'/'+devis.num_version+'/'+devis.nom_chantier]" class="col-sm-offset-8 col-sm-1 btn" type="button"  *ngIf="!print && droitsuser.accesdev" (click)=" imprimer()">Imprimer </button>
-->




    <div class=" container-fluid "  id="pageContent" style="z-index:10; ">


        <div class="row marge">
            <img  src="image/logo_wBAT_horizontal.png"  style="margin-left:-1000px;">
        </div>
        <div class="row marge">
            <img *ngIf="print" src="image/logo_jd.png" class="col-sm-2 col-sm-offset-5" style="text-align: center;margin-left:35%; top:0px; position: absolute;">

        </div>

        <p>&nbsp;</p>
        <div *ngIf="print" style="position:absolute;z-index: -10;margin-top:40%;">
            <img src="image/fili.png">
        </div>

        <div  style="margin-left: 50%;margin-top: -30px;">
            <div class="form-group " style="font-weight: bold;">
                <span>{{devis.raison_sociale ? devis.raison_sociale : devis.nom +" " +devis.prenom}}</span>
            </div>


            <div class="form-group" *ngIf="address" >
                <span class=" glyphicon glyphicon-alert red"></span><span class="col-sm-9">Aucune adresse pré-enregistrée pour ce client</span>
            </div>
            <div  class="form-group ">


                <div   class="form-group" >
                    <span>{{devis.adresse}}</span>
                </div>
                <div  class="form-group" >
                    <span style="text-align: center;">{{devis.code_postal}} - {{devis.ville}}</span>
                </div>
            </div>



            </div>
        </div>




        <div class="col-sm-5" style="margin:0px;font-size: 18px;">
            <div class="form-group" >
                <label class="col-sm-4" style="text-decoration: underline;">Objet :</label>
                <span> Devis n° : {{id}} </span>

                <span style=" padding-left:50px;"> Version :{{devis.num_version}} </span>
            </div>


            <div   class="form-group" *ngIf="devis.nom_chantier && !print">
                <label class="col-sm-4" style="text-decoration: underline;">Operation :</label>
                <span >{{devis.raison_sociale ? devis.raison_sociale : devis.nom +" " +devis.prenom}}-{{devis.nom_chantier}}<br />
                 <span >{{devis.adresse}}</span><br />
                 <span style="margin-left:210px;">{{devis.code_postal}} - {{devis.ville}}</span>

                </span>
            </div>

            <div  class="form-group" *ngIf="devis.nom_chantier && print">
                <label class="col-sm-4" style="text-decoration: underline;">Operation :</label>
                <span style="text-align: center;margin-left:15px;">{{devis.raison_sociale ? devis.raison_sociale : devis.nom +" " +devis.prenom}}-{{devis.nom_chantier}}<br />
                     <span style="text-align: center;margin-left:150px;">{{devis.adresse}}</span><br />
                     <span style="text-align: center;margin-left:150px;">{{devis.code_postal}} - {{devis.ville}}</span>

                </span>
            </div>
        </div>


        <div class="form-group" style="margin-top: 20px; margin-left:45%;">
            <span>A {{fact.ville_a}},</span><span> le {{devis.date_version | date:'dd-MM-yyyy'}}</span>
        </div>


        <table  style="width: 100%;font-size:18px;z-index:1;margin-bottom:50px;height:100%;text-align: center;"  >
            <thead style="height: 80px;  background:grey;text-align: center;" >
            <tr style="height: 50px;font-size: 22px;">

                <th colspan="10" style="border-bottom:1px solid black; border-top:1px solid black;border-left: 1px solid black;text-align: center;" class="col-sm-4">Désignation</th>


                <th  style="border-bottom:1px solid black;border-top:1px solid black;border-right: 1px solid black;border-left:1px solid black;" class="col-sm-1">Réf</th>
                <th style="border-bottom:1px solid black;border-top:1px solid black;border-right: 1px solid black;"class="col-sm-1" >Unité</th>
                <th  style="border-bottom:1px solid black;border-top:1px solid black;border-right: 1px solid black; width: 50px;" class="col-sm-1">Qte</th>
                <th style="border-bottom:1px solid black;border-top:1px solid black;border-right: 1px solid black;width: 150px;" class="col-sm-1">P.U. HT</th>
                <th style="border-right: 1px solid black;border-bottom:1px solid black;border-top:1px solid black;text-align: center;" class="col-sm-1">Total HT</th>
            </tr>
            </thead>
            <tbody style="text-align: center;">

            <ng-container *ngFor="let produit of produitDevis; let i = index" style="height: 10px;">
                <tr  >


                    <td colspan="10"  style="border-bottom: 1px solid black;border-left:1px solid black;text-align: center;">
                        <div  class="form-group">
                            <span style="font-weight: bold;text-align: center;">{{produit.libelle}}</span><br>
                            <span *ngIf="produit.commentaire">{{produit.commentaire}}</span>
                        </div>
                    </td>


                    <td style="border-right: 1px solid black;border-bottom: 1px solid black;border-left: 1px solid black;width: 30px;text-align: center;">
                        <div class="form-group" >
                            <span >{{produit.id_prc}}</span>
                        </div>
                    </td>
                    <td  style="border-right: 1px solid black;border-bottom: 1px solid black;text-align: center;">
                        <div class="form-group">
                            <span>{{produit.unite}}</span>
                        </div>
                    </td>
                    <td  style="border-right: 1px solid black;border-bottom: 1px solid black;text-align: center;">
                        <div class="form-group">
                            {{produitDevis[i].qte_devis}}
                        </div>
                    </td>
                    <td  style="border-bottom: 1px solid black;border-right: 1px solid black;text-align: center;">
                        <div class="form-group">
                            {{produitDevis[i].prix_devis| currency:'EUR':true:'1.2-2'}}
                        </div>
                    </td>
                    <td  style="border-right: 1px solid black;border-bottom: 1px solid black;text-align: center;">
                        <div class="form-group">{{produitDevis[i].qte_devis * produitDevis[i].prix_devis| currency:'EUR':true:'1.2-2' }}</div>
                    </td>

                </tr>


            </ng-container>
            <p>&nbsp;</p>
            <tr style="height: 10px;border:none;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>

                <td  colspan="1"  style="text-align: left;border-left: 1px solid;border-top:1px solid black;" >HT :</td>

                <td style="border-top: 1px solid;border-right:1px solid black;text-align: right;" >{{countTotal() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>

            <tr *ngIf="produitDevis.length > 0  && devis.remise"  style="height: 30px;margin-left:90%;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1"  style="text-align: left;margin-left:90%;border-top:1px solid black;border-left: 1px solid black;border-bottom:1px solid black;">Remise {{devis.remise}} %:</td>
                <td style="border-top:1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;text-align: right;">{{totalRemiseprod() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr>
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td   colspan="1" style="text-align: left;border-left: 1px solid;border-top: 1px solid black" >TVA {{devis.tva}} %:</td>

                <td style="border-right:1px solid black;border-top: 1px solid black;text-align: right;" >{{countTVAprod() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr >

            <tr >
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td  colspan="1" style="text-align: left;border-left:1px solid black;border-top: 1px solid black;border-bottom:1px solid black;">
                    TTC:
                </td>

                <td style="border-right:1px solid black;border-top: 1px solid black;border-bottom:1px solid black;text-align: right;" >{{countTotalTVA()  | currency:'EUR':true:'1.2-2'}}</td>

            </tr>

            <p>&nbsp;</p>


            <tr *ngIf="produitDevisOptions.length > 0" style="border:1px solid grey;border-top:1px solid grey;text-align: center;"   >
                <th colspan="10" style="border-bottom:1px solid grey;border-top:1px solid grey;text-align: center;" class="col-sm-5">Options:  Désignation</th>

                <th style="border-bottom:1px solid black;border-right: 1px solid black;border-top:1px solid grey;border-left:1px solid black;" class="col-sm-1"> Réf</th>

                <th style="border-bottom:1px solid black;border-right: 1px solid black;border-top:1px solid;" class="col-sm-1">Unité</th>
                <th  style="border-bottom:1px solid black;border-right: 1px solid black;border-top:1px solid;" class="col-sm-1">Qte</th>
                <th style="border-bottom:1px solid black;border-right: 1px solid black;border-top:1px solid;" class="col-sm-1">P.U. HT</th>
                <th style="border-right: 1px solid black;border-bottom:1px solid black;border-top:1px solid;" class="col-sm-1">Total HT:</th>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>

            <tr *ngFor="let produit of produitDevisOptions; let i = index"  style="height: 10px;">

                <td  colspan="10" style="border-bottom:1px solid grey;border-left:1px solid grey;">


                    <div class="form-group">
                        <input *ngIf="!print" style="width: 10px;margin-left:0px;" type="checkbox" [(ngModel)]="produitDevisOptions[i].accepted" name="accepted{{i}}" (ngModelChange)="acceptOffer(produitDevisOptions[i])">

                        <span>{{produit.libelle}}</span><br>
                        <span *ngIf="produit.commentaire">{{produit.commentaire}}</span>
                    </div>
                </td>

                <td style="border-bottom:1px solid black;border-left: 1px solid;border-right: 1px solid black;">
                    <div class="form-group">
                        <span>{{produit.id_prc}}</span>
                    </div>
                </td>
                <td style="border-bottom:1px solid black;border-right: 1px solid black;">
                    <div class="form-group">
                        <span>{{produit.unite}}</span>
                    </div>
                </td>
                <td style="border-bottom:1px solid black;border-right: 1px solid black;">
                    <div class="form-group">
                        {{produitDevisOptions[i].qte_devis}}
                    </div>
                </td>
                <td style="border-bottom:1px solid black;border-right: 1px solid black;">
                    <div class="form-group">
                        {{produitDevisOptions[i].prix_devis | currency:'EUR':true:'1.2-2'}}
                    </div>
                </td>
                <td style="border-bottom:1px solid black;border-right: 1px solid black;">
                    <div class="form-group">{{produitDevisOptions[i].qte_devis * produitDevisOptions[i].prix_devis  | currency:'EUR':true:'1.2-2'}}</div>
                </td>

            </tr>

            <p>&nbsp;</p>

            <tr *ngIf="produitDevisOptions.length> 0"  style="height: 10px;margin-left:90%;">


                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1" style="text-align:left;border-top:1px solid black;border-left: 1px solid black;">HT :</td>
                <td style="border-top:1px solid black;border-right: 1px solid black;text-align: right;">{{countTotalOptions() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevisOptions.length> 0 && devis.remise" style="height: 30px;margin-left:90%;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1"  style="text-align: left;margin-left:90%;border-top:1px solid black;border-left: 1px solid black;border-bottom:1px solid black;">Remise {{devis.remise}} %:</td>
                <td style="text-align: right;border-right:1px solid black;border-top: 1px solid black;border-bottom:1px solid black;text-align: right;" >{{countTotalOptionRemise() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevisOptions.length> 0"  style="height: 10px;margin-left:90%;">
                <td colspan="13"></td>
                <td style="border-top:1px solid black;border-left:1px solid black;text-align: left;">TVA {{devis.tva}} %</td>
                <td style="border-right:1px solid black;border-top: 1px solid black;text-align: right;" >{{countTotalOptionsTVA() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevisOptions.length> 0"  style="height: 30px;margin-left:90%;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1"  style="text-align: left;margin-left:90%;border-top:1px solid black;border-left: 1px solid black;border-bottom:1px solid black;">TTC :</td>
                <td style="text-align: right;border-right:1px solid black;border-top: 1px solid black;border-bottom:1px solid black;text-align: right;" class="droit">{{Totaloption() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>


            <p>&nbsp;</p>


            <tr *ngIf="produitDevis.length> 0 && produitDevisOptions.length> 0"  style="height: 10px;margin-left:90%;">


                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1" style="text-align: left;border-top:1px solid black;border-left: 1px solid black;">HT :</td>
                <td style="border-top:1px solid black;border-right: 1px solid black;text-align: right;">{{total() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevis.length > 0 && produitDevisOptions.length> 0 && devis.remise"  style="height: 30px;margin-left:90%;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1"  style="text-align: left;margin-left:90%;border-top:1px solid black;border-left: 1px solid black;border-bottom:1px solid black;">Remise {{devis.remise}} %:</td>
                <td style="border-top:1px solid black;border-right: 1px solid black;border-bottom: 1px solid black;text-align: right;">{{ countTotalRemise() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevisOptions.length> 0"  style="height: 10px;margin-left:90%;">
                <td colspan="13"></td>
                <td   colspan="1" style="text-align: left;border-left: 1px solid;border-top: 1px solid black" >TVA {{devis.tva}} %:</td>

                <td style="border-right:1px solid black;border-top: 1px solid black;text-align: right;" >{{TVAtotal() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>
            <tr *ngIf="produitDevis.length > 0 && produitDevisOptions.length> 0"  style="height: 30px;margin-left:90%;">
                <td style="border:none;position: relative;z-index:-120" colspan="13">&nbsp;</td>
                <td colspan="1"  style="text-align: left;margin-left:90%;border-top:1px solid black;border-left: 1px solid black;border-bottom:1px solid black;">TTC :</td>
                <td style="border-top:1px solid black;border-right: 1px solid black;border-bottom:1px solid black;text-align: right;">{{totalTVA() | currency:'EUR':true:'1.2-2'}}</td>
                <!--calcul la somme de toutes quantités ajouté au bon de commande-->
            </tr>

            <tr style="height: 10px;">
                <td class="col-sm-12" style="text-align: left;position: relative;z-index: 10;">Conditions de règlement :</td>


            </tr>
            <tr style="height: 10px;margin-bottom: 50px;position: relative;z-index: -120;">
                <td style="text-align: left;border:none;position: relative;z-index:10;">Acompte
                    <div style="position: relative;z-index:10;" *ngIf="devis.accompte">
                        <div  *ngIf="devis.accompte_percent">

                            Acompte à la signature du devis: {{devis.accompte_percent}}%

                        </div>


                    </div>
                    <div style="background-color: transparent;position: relative;z-index:10;" class="form-group" *ngIf="devis.accompte_value">

                        Acompte à la signature du devis: {{devis.accompte_value| currency:'EUR':true:'1.2-2'}}€

                    </div>
                </td>
            </tr>


            </tbody>


        </table>






        <div class="form-group col-sm-4" *ngIf="print"  id="pageFooter" style="height: 50px;page-break-before:always;page-break-inside: avoid;">




            <article style="margin-top: 10px;bottom:35px;left: 0; right: 0;position: fixed;text-align: center;z-index: 4;" >

                <p style="font-size:11px; height: 10px;margin-top:10px;" class="red">{{fact.pied_page1}}
                    {{fact.pied_page2}}
                    {{fact.pied_page3}}
                    {{fact.pied_page4}}
                    {{fact.pied_page5}}
                    {{fact.pied_page6}}</p>
            </article>



        </div>
        <div   style="font-size: 12px;position:relative;page-break-before:always;page-break-inside: avoid;text-align: justify;" *ngIf="print"  id="cgv">

            <img *ngIf="print" src="image/logo_jd.png" class="col-sm-2 col-sm-offset-5" style="text-align: center;margin-left:25%; top:0px; position: absolute;">


            <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
            <p style="text-align: justify;">{{cgv.texte}}</p>
        </div>
    </body>
    </div>



